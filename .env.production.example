# ============================================================================
# NutriVault Production Environment Configuration for Docker
# ============================================================================
# Copy this file to .env.production and update with your production values
# IMPORTANT: Never commit .env.production to version control
# SECURITY: Protect this file with: chmod 600 .env.production
# ============================================================================

# ============================================================================
# PORTS CONFIGURATION
# ============================================================================
# Frontend port (default: 80 for production HTTP, use 443 for HTTPS with reverse proxy)
FRONTEND_PORT=80

# Backend API port (default: 3001)
BACKEND_PORT=3001

# ============================================================================
# PUBLIC URL CONFIGURATION
# ============================================================================
# Public URL for the frontend (used in email links like unsubscribe)
# Set this to your production domain
FRONTEND_URL=https://your-domain.com

# ============================================================================
# JWT SECURITY CONFIGURATION - CRITICAL
# ============================================================================
# IMPORTANT: Generate strong random secrets for production
# Command: openssl rand -base64 64
# Never use default values in production!

JWT_SECRET=CHANGE_ME_GENERATE_STRONG_SECRET_AT_LEAST_64_CHARACTERS_LONG_USE_OPENSSL_RAND
REFRESH_TOKEN_SECRET=CHANGE_ME_GENERATE_DIFFERENT_STRONG_SECRET_AT_LEAST_64_CHARACTERS_LONG

# Token expiration times
JWT_ACCESS_EXPIRATION=30m
JWT_REFRESH_EXPIRATION=30d
JWT_ISSUER=nutrivault-production

# ============================================================================
# AUTHENTICATION & SECURITY
# ============================================================================
# Maximum failed login attempts before account lockout
MAX_LOGIN_ATTEMPTS=5

# Lockout duration in minutes after exceeding max attempts
LOCKOUT_DURATION_MINUTES=30

# ============================================================================
# CORS CONFIGURATION
# ============================================================================
# Allowed CORS origins (comma-separated, no spaces)
# Examples:
#   - Single domain: https://nutrivault.example.com
#   - Multiple domains: https://nutrivault.example.com,https://app.example.com
#   - With www: https://example.com,https://www.example.com
ALLOWED_ORIGINS=https://your-domain.com

# ============================================================================
# FILE UPLOAD CONFIGURATION
# ============================================================================
# Maximum file size in bytes
# 10MB = 10485760 bytes
# 50MB = 52428800 bytes
MAX_FILE_SIZE=10485760

# ============================================================================
# EMAIL CONFIGURATION
# ============================================================================
# SMTP server settings
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_SECURE=false

# Email authentication credentials
# For Gmail: Use App-Specific Password (not your regular password)
# https://support.google.com/accounts/answer/185833
EMAIL_USER=your-email@example.com
EMAIL_PASSWORD=your-app-specific-password-here

# Sender name displayed in outgoing emails
EMAIL_FROM_NAME=NutriVault

# ============================================================================
# DATABASE INITIALIZATION FLAGS
# ============================================================================
# These flags control database initialization on container startup

# Seed database with sample data (recommended: false for production)
SEED_DB=false

# NOTE: L'utilisateur admin doit être créé manuellement après le premier démarrage
# Voir les instructions dans DEPLOYMENT.md ou README.Docker.md
# Les anciennes variables CREATE_ADMIN, ADMIN_USERNAME, ADMIN_PASSWORD ne sont plus utilisées

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
# Log level: error | warn | info | debug
# Production recommended: info or warn
LOG_LEVEL=info

# ============================================================================
# PRODUCTION DEPLOYMENT CHECKLIST
# ============================================================================
# Before deploying to production, ensure you have:
#
# [ ] Replaced all CHANGE_ME values with secure production values
# [ ] Generated JWT secrets using: openssl rand -base64 64
# [ ] Configured your production domain in ALLOWED_ORIGINS
# [ ] Set up email SMTP credentials (test email delivery)
# [ ] Created strong admin password (min 12 characters)
# [ ] Set CREATE_ADMIN=true for FIRST deployment only
# [ ] Protected this file with: chmod 600 .env.production
# [ ] Set up HTTPS/SSL with reverse proxy (nginx/traefik)
# [ ] Configured firewall rules
# [ ] Set up automated database backups
# [ ] Tested all environment variables work correctly
# [ ] Reviewed security headers in nginx.conf
# [ ] Configured log rotation
# [ ] Set up monitoring/alerting
#
# ============================================================================
# QUICK START COMMANDS
# ============================================================================
#
# 1. Generate JWT secrets:
#    openssl rand -base64 64
#
# 2. Copy this file:
#    cp .env.production.example .env.production
#
# 3. Edit with secure values:
#    nano .env.production
#
# 4. Protect the file:
#    chmod 600 .env.production
#
# 5. Build and start:
#    docker-compose --env-file .env.production up -d --build
#
# 6. View logs:
#    docker-compose logs -f
#
# 7. Check health:
#    curl http://localhost/health
#    curl http://localhost:3001/health
#
# ============================================================================
